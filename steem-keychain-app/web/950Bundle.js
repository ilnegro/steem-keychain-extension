"use strict";(self.webpackChunksteem_keychain=self.webpackChunksteem_keychain||[]).push([[950],{9201:(t,e,n)=>{n.d(e,{E:()=>s});var a=n(39756),o=n(89686),i=n(73841),r=n(935),c=n(96763);const s=t=>e=>{return n=void 0,s=void 0,T=function*(){try{o.u.setRpc(t),yield r.A.saveValueInLocalStorage(i.Z.CURRENT_RPC,t),e({type:a.R.SET_ACTIVE_RPC,payload:t})}catch(t){c.error("[ActiveRpcActions] Error setting active RPC:",t)}},new((_=void 0)||(_=Promise))((function(t,e){function a(t){try{i(T.next(t))}catch(t){e(t)}}function o(t){try{i(T.throw(t))}catch(t){e(t)}}function i(e){var n;e.done?t(e.value):(n=e.value,n instanceof _?n:new _((function(t){t(n)}))).then(a,o)}i((T=T.apply(n,s||[])).next())}));var n,s,_,T}},21561:(t,e,n)=>{n.d(e,{Y:()=>i,l:()=>o});var a=n(39756);const o=t=>({type:a.R.SET_SWITCH_TO_RPC,payload:t}),i=t=>({type:a.R.SET_DISPLAY_SWITCH_RPC,payload:t})},21749:(t,e,n)=>{n.d(e,{$:()=>o});var a=n(45038);const o=t=>({type:a.r.SET_HAS_FINISHED_SIGNUP,payload:t})},22913:(t,e,n)=>{n.d(e,{A:()=>i});var a=n(73841),o=n(935);const i={isEmpty:t=>!t.account||0===Object.keys(t.account).length,saveActiveAccountNameInLocalStorage:t=>{o.A.saveValueInLocalStorage(a.Z.ACTIVE_ACCOUNT_NAME,t)},getActiveAccountNameFromLocalStorage:()=>{return t=void 0,e=void 0,i=function*(){const t=yield o.A.getValueFromLocalStorage(a.Z.ACTIVE_ACCOUNT_NAME);return t&&t.length?t:void 0},new((n=void 0)||(n=Promise))((function(a,o){function r(t){try{s(i.next(t))}catch(t){o(t)}}function c(t){try{s(i.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?a(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,c)}s((i=i.apply(t,e||[])).next())}));var t,e,n,i},removeAuthorizedAccount:(t,e,n)=>{const a=Object.assign({},t);return a.account[e]=Object.assign(Object.assign({},a.account[e]),{account_auths:a.account[e].account_auths.filter((t=>t[0]!==n))}),a}}},32888:(t,e,n)=>{var a;n.d(e,{G:()=>a}),function(t){t.ERROR="ERROR",t.WARNING="WARNING",t.SUCCESS="SUCCESS",t.INFO="INFO"}(a||(a={}))},39756:(t,e,n)=>{var a;n.d(e,{R:()=>a}),function(t){t.GET_ACCOUNTS="GET_ACCOUNTS",t.ADD_ACCOUNT="ADD_ACCOUNT",t.SET_ACCOUNTS="SET_ACCOUNTS",t.RESET_ACCOUNT="RESET_ACCOUNT",t.SET_ACTIVE_ACCOUNT="ACTIVE_ACCOUNT",t.SET_ACTIVE_ACCOUNT_RC="ACTIVE_ACCOUNT_RC",t.FORGET_ACCOUNT="FORGET_ACCOUNT",t.FORGET_ACCOUNTS="FORGET_ACCOUNTS",t.RESET_ACTIVE_ACCOUNT="RESET_ACTIVE_ACCOUNT",t.SET_ACTIVE_RPC="SET_ACTIVE_RPC",t.ADD_CUSTOM_RPC="ADD_CUSTOM_RPC",t.LOAD_CURRENCY_PRICES="LOAD_CURRENCY_PRICES",t.LOAD_GLOBAL_PROPS="LOAD_GLOBAL_PROPS",t.FETCH_CONVERSION_REQUESTS="FETCH_CONVERSION_REQUESTS",t.FETCH_DELEGATEES="FETCH_DELEGATEES",t.FETCH_DELEGATORS="FETCH_DELEGATORS",t.FETCH_PENDING_OUTGOING_UNDELEGATION="FETCH_PENDING_OUTGOING_UNDELEGATION",t.LOAD_TOKEN_HISTORY="LOAD_TOKEN_HISTORY",t.FETCH_MORE_TOKEN_HISTORY="FETCH_MORE_TOKEN_HISTORY",t.INIT_TOKEN_HISTORY="INIT_TOKEN_HISTORY",t.LOAD_TOKENS_MARKET="LOAD_TOKENS_MARKET",t.LOAD_TOKENS="LOAD_TOKENS",t.CLEAR_USER_TOKENS="CLEAR_USER_TOKENS",t.LOAD_USER_TOKENS="LOAD_USER_TOKENS",t.LOAD_PENDING_UNSTAKING="LOAD_PENDING_UNSTAKING",t.FETCH_PHISHING_ACCOUNTS="FETCH_PHISHING_ACCOUNTS",t.ADD_TRANSACTIONS="ADD_TRANSACTIONS",t.INIT_TRANSACTIONS="INIT_TRANSACTIONS",t.HE_SET_ACTIVE_RPC="HE_SET_ACTIVE_RPC",t.HE_SET_ACTIVE_ACCOUNT_HISTORY_API="HE_SET_ACTIVE_ACCOUNT_HISTORY_API",t.HE_LOAD_CONFIG="HE_LOAD_CONFIG",t.SET_APP_STATUS="SET_APP_STATUS",t.SET_SWITCH_TO_RPC="SET_SWITCH_TO_RPC",t.SET_DISPLAY_SWITCH_RPC="SET_DISPLAY_SWITCH_RPC",t.IS_LOADING="IS_LOADING"}(a||(a={}))},40416:(t,e,n)=>{n.d(e,{M:()=>I});var a=n(21749),o=n(45038),i=n(32888);const r=(t,e)=>{let n=t.stack;return(null==e?void 0:e.resetStack)&&(n=[]),e&&e.nextPage&&(t.stack[0]&&e.nextPage!==t.stack[0].currentPage||!t.stack[0])?{stack:[{currentPage:e.nextPage,params:e.params},...n],params:e.params}:t};var c=n(39756);const s={processingDecryptAccount:!1,priceLoaded:!1,globalPropertiesLoaded:!1};var _=n(7028);var T=n(70764);var E=n(91829);const A=(0,E.HY)({accounts:(t=[],{type:e,payload:n})=>{switch(e){case c.R.GET_ACCOUNTS:case c.R.SET_ACCOUNTS:return n;case c.R.ADD_ACCOUNT:{const e=n;return[...t,e]}case c.R.RESET_ACCOUNT:return[];default:return t}},activeAccount:(t={account:{},keys:{},rc:{}},{type:e,payload:n})=>{switch(e){case c.R.SET_ACTIVE_ACCOUNT:return Object.assign(Object.assign({},t),n);case c.R.SET_ACTIVE_ACCOUNT_RC:return Object.assign(Object.assign({},t),{rc:n});case c.R.FORGET_ACCOUNT:case c.R.FORGET_ACCOUNTS:case c.R.RESET_ACTIVE_ACCOUNT:return{account:{},keys:{},rc:{}};default:return t}},activeRpc:(t={uri:"NULL",testnet:!1},{type:e,payload:n})=>e===c.R.SET_ACTIVE_RPC?n:t,currencyPrices:(t={bitcoin:{},steem:{},steem_dollars:{}},{type:e,payload:n})=>e===c.R.LOAD_CURRENCY_PRICES?n:t,globalProperties:(t={},{type:e,payload:n})=>e===c.R.LOAD_GLOBAL_PROPS?n:t,delegations:(t={incoming:[],outgoing:[],pendingOutgoingUndelegation:[]},{type:e,payload:n})=>{switch(e){case c.R.FETCH_DELEGATEES:return Object.assign(Object.assign({},t),{outgoing:n.outgoing});case c.R.FETCH_DELEGATORS:return Object.assign(Object.assign({},t),{incoming:n.incoming});case c.R.FETCH_PENDING_OUTGOING_UNDELEGATION:return Object.assign(Object.assign({},t),{pendingOutgoingUndelegation:n.pendingOutgoingUndelegation});default:return t}},conversions:(t=[],{type:e,payload:n})=>e===c.R.FETCH_CONVERSION_REQUESTS?n:t,phishing:(t=[],{type:e,payload:n})=>e===c.R.FETCH_PHISHING_ACCOUNTS?n:t,transactions:(t={loading:!1,list:[],lastUsedStart:-1},{type:e,payload:n})=>{switch(e){case c.R.SET_ACTIVE_ACCOUNT:return{loading:!0,list:[],lastUsedStart:-1};case c.R.INIT_TRANSACTIONS:return{loading:!1,list:n};case c.R.ADD_TRANSACTIONS:return Object.assign(Object.assign({},t),{list:T.A.mergeWithoutDuplicate(t.list,n[0],"key"),lastUsedStart:n[0][n[0].length-1].txId});default:return t}},userTokens:(t={loading:!1,list:[]},{type:e,payload:n})=>{switch(e){case c.R.CLEAR_USER_TOKENS:return{loading:!0,list:[]};case c.R.LOAD_USER_TOKENS:return{loading:!1,list:n};default:return t}},tokens:(t=[],{type:e,payload:n})=>e===c.R.LOAD_TOKENS?n:t,tokenHistory:(t={loading:!1,shouldLoadMore:!1,list:[]},{type:e,payload:n})=>{switch(e){case c.R.INIT_TOKEN_HISTORY:return{loading:!0,list:[],shouldLoadMore:!1};case c.R.LOAD_TOKEN_HISTORY:return{loading:!1,list:null==n?void 0:n.transactions,shouldLoadMore:null==n?void 0:n.shouldLoadMore};case c.R.FETCH_MORE_TOKEN_HISTORY:return{loading:!1,list:[...t.list,...null==n?void 0:n.transactions],shouldLoadMore:null==n?void 0:n.shouldLoadMore};case c.R.IS_LOADING:return Object.assign(Object.assign({},t),{loading:!0});default:return t}},tokenMarket:(t=[],{type:e,payload:n})=>e===c.R.LOAD_TOKENS_MARKET?n:t,steemEngineConfig:(t={rpc:_.A.steemEngine.rpc,mainnet:_.A.steemEngine.mainnet,accountHistoryApi:_.A.steemEngine.accountHistoryApi},{type:e,payload:n})=>{switch(e){case c.R.HE_SET_ACTIVE_ACCOUNT_HISTORY_API:return Object.assign(Object.assign({},t),{accountHistoryApi:null==n?void 0:n.accountHistoryApi});case c.R.HE_SET_ACTIVE_RPC:return Object.assign(Object.assign({},t),{rpc:null==n?void 0:n.rpc});case c.R.HE_LOAD_CONFIG:return Object.assign(Object.assign({},t),{rpc:null==n?void 0:n.rpc,accountHistoryApi:null==n?void 0:n.accountHistoryApi});default:return t}},appStatus:(t=s,{type:e,payload:n})=>e===c.R.SET_APP_STATUS?Object.assign(Object.assign({},t),n):t,rpcSwitcher:(t={display:!1},{type:e,payload:n})=>{switch(e){case c.R.SET_SWITCH_TO_RPC:return Object.assign(Object.assign({},t),{rpc:n});case c.R.SET_DISPLAY_SWITCH_RPC:return Object.assign(Object.assign({},t),{display:n});default:return t}},tokensPendingUnstaking:(t=[],{type:e,payload:n})=>e===c.R.LOAD_PENDING_UNSTAKING?n:t}),u=(0,E.HY)({mk:(t="",{type:e,payload:n})=>e===o.r.SET_MK?n:t,message:(t={key:"",type:i.G.SUCCESS},{type:e,payload:n})=>e===o.r.SET_MESSAGE?n:t,navigation:(t={stack:[]},{type:e,payload:n})=>{var a;switch(e){case o.r.RESET_NAV:return{stack:[],params:null};case o.r.NAVIGATE_TO:case o.r.NAVIGATE_TO_WITH_PARAMS:return r(t,n);case o.r.GO_BACK:{const e=t.stack;return e.length>1&&(e[1].previousParams=e[0].params),e.shift(),{stack:e}}case o.r.GO_BACK_TO_THEN_NAVIGATE:{const e=t.stack,o=null!==(a=null==n?void 0:n.goBackTo)&&void 0!==a?a:e[1].currentPage;do{e.length>1&&(e[1].previousParams=e[0].params),e.shift()}while(o!==e[0].currentPage);return r({stack:e},n)}default:return t}},loading:(t={loadingOperations:[],caption:void 0},{type:e,payload:n})=>{switch(e){case o.r.ADD_TO_LOADING_LIST:{const e=n;if(t.loadingOperations.find((t=>t.name===(null==e?void 0:e.operation)))){const n={loadingOperations:[...t.loadingOperations]};for(let t of n.loadingOperations)t.name===(null==e?void 0:e.operation)&&(t.done=!1);return n}{const n={loadingOperations:[...t.loadingOperations],caption:t.caption};return n.loadingOperations.push({name:e.operation,operationParams:e.operationParams,hideDots:e.hideDots,done:!1}),n}}case o.r.REMOVE_FROM_LOADING_LIST:{const e=n,a={loadingOperations:[...t.loadingOperations],caption:t.caption,loadingPercentage:t.loadingPercentage};for(let t of a.loadingOperations)t.name===(null==e?void 0:e.operation)&&(t.done=!0);return a.loadingOperations.some((t=>!1===t.done))?a:{loadingOperations:[],caption:void 0,loadingPercentage:void 0}}case o.r.ADD_CAPTION_TO_LOADING_PAGE:{const e=n;return{loadingOperations:[...t.loadingOperations],caption:e.caption,loadingPercentage:t.loadingPercentage}}case o.r.ADD_LOADING_PERCENTAGE:{const e=n;return{loadingOperations:[...t.loadingOperations],caption:t.caption,loadingPercentage:e.loadingPercentage}}default:return t}},titleContainer:(t={title:""},{type:e,payload:n})=>e===o.r.SET_TITLE_PROPERTIES?n:t,steem:A,hasFinishedSignup:(t=null,{type:e,payload:n})=>e===o.r.SET_HAS_FINISHED_SIGNUP?n:t,modal:(t=null,{type:e,payload:n})=>{switch(e){case o.r.OPEN_MODAL:return n;case o.r.CLOSE_MODAL:return null;default:return t}}});var O,l=n(73841),S=n(1265),C=n(44952),d=n(22913),R=n(51616),N=n(935);const I=(0,E.y$)(u,(0,E.Tw)(S.A));if(I.getState().steem){let t=I.getState().steem.accounts,e=I.getState().steem.activeRpc,n=null===(O=I.getState().steem.activeAccount)||void 0===O?void 0:O.name,o=I.getState().mk,i=I.getState().steem.steemEngineConfig;I.subscribe((()=>{const{mk:r,steem:{accounts:c,activeRpc:s,activeAccount:_,steemEngineConfig:T},hasFinishedSignup:E}=I.getState();var A,u,O,S;A=void 0,u=void 0,S=function*(){C.Ay.isAccountListIdentical(t,c)||(0!==t.length||t.length===c.length||E||(yield N.A.saveValueInLocalStorage(l.Z.HAS_FINISHED_SIGNUP,!0),I.dispatch((0,a.$)(!0))),t=c,0!==c.length&&C.Ay.saveAccounts(c,r)),e&&e.uri!==(null==s?void 0:s.uri)&&s&&(e=s,R.A.saveCurrentRpc(s)),_&&n!==_.name&&(n=_.name,d.A.saveActiveAccountNameInLocalStorage(_.name)),o!==r&&(o=r),i&&T&&(i.accountHistoryApi!==T.accountHistoryApi||i.rpc!==T.rpc)&&(i=T,yield N.A.saveValueInLocalStorage(l.Z.STEEM_ENGINE_ACTIVE_CONFIG,T))},new((O=void 0)||(O=Promise))((function(t,e){function n(t){try{o(S.next(t))}catch(t){e(t)}}function a(t){try{o(S.throw(t))}catch(t){e(t)}}function o(e){var o;e.done?t(e.value):(o=e.value,o instanceof O?o:new O((function(t){t(o)}))).then(n,a)}o((S=S.apply(A,u||[])).next())}))}))}},45038:(t,e,n)=>{var a;n.d(e,{r:()=>a}),function(t){t.TEST_MSG="TEST_MSG",t.SET_MK="SET_MK",t.SET_MESSAGE="SET_MESSAGE",t.OPEN_MODAL="OPEN_MODAL",t.CLOSE_MODAL="CLOSE_MODAL",t.NAVIGATE_TO="NAVIGATE_TO",t.NAVIGATE_TO_WITH_PARAMS="NAVIGATE_TO_WITH_PARAMS",t.GO_BACK="GO_BACK",t.RESET_NAV="RESET_NAV",t.GO_BACK_TO_THEN_NAVIGATE="GO_BACK_TO_THEN_NAVIGATE",t.SET_LOADING="SET_LOADING",t.ADD_TO_LOADING_LIST="ADD_TO_LOADING_LIST",t.REMOVE_FROM_LOADING_LIST="REMOVE_FROM_LOADING_LIST",t.ADD_CAPTION_TO_LOADING_PAGE="ADD_CAPTION_TO_LOADING_PAGE",t.ADD_LOADING_PERCENTAGE="ADD_LOADING_PERCENTAGE",t.SET_TITLE_PROPERTIES="SET_TITLE_PROPERTIES",t.RESET_TITLE_PROPERTIES="RESET_ACTION_PROPERTIES",t.SET_HAS_FINISHED_SIGNUP="SET_HAS_FINISHED_SIGNUP"}(a||(a={}))},51616:(t,e,n)=>{n.d(e,{A:()=>O});var a=n(89686),o=n(72505),i=n.n(o),r=n(61762),c=n(73841),s=n(935),_=n(15507),T=function(t,e,n,a){return new(n||(n=Promise))((function(o,i){function r(t){try{s(a.next(t))}catch(t){i(t)}}function c(t){try{s(a.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,c)}s((a=a.apply(t,e||[])).next())}))};const E=()=>r.k.map((t=>Object.assign(Object.assign({},t),{uri:t.uri.endsWith("/")?t.uri.substring(0,t.uri.length-1):t.uri}))),A=t=>{s.A.saveValueInLocalStorage(c.Z.RPC_LIST,t)},u={getFullList:E,addCustomRpc:t=>T(void 0,void 0,void 0,(function*(){const e=(yield s.A.getValueFromLocalStorage(c.Z.RPC_LIST))||[];e.push(t),s.A.saveValueInLocalStorage(c.Z.RPC_LIST,e)})),getCurrentRpc:()=>T(void 0,void 0,void 0,(function*(){let t=yield s.A.getValueFromLocalStorage(c.Z.CURRENT_RPC);return t=t||{uri:"DEFAULT",testnet:!1},t.uri.endsWith("/")&&(t=Object.assign(Object.assign({},t),{uri:t.uri.substring(0,t.uri.length-1)})),t})),saveCurrentRpc:t=>{s.A.saveValueInLocalStorage(c.Z.CURRENT_RPC,t)},getCustomRpcs:()=>T(void 0,void 0,void 0,(function*(){return(yield s.A.getValueFromLocalStorage(c.Z.RPC_LIST))||[]})),isDefault:t=>void 0!==r.k.find((e=>(e.uri.trim().endsWith("/")?e.uri.trim().substring(0,e.uri.trim().length-1):e.uri.trim())===(t.uri.trim().endsWith("/")?t.uri.trim().substring(0,t.uri.trim().length-1):t.uri.trim()))),saveCustomRpc:A,deleteCustomRpc:(t,e)=>{const n=t.filter((t=>e.uri!==t.uri));return A(n),n},findRpc:t=>T(void 0,void 0,void 0,(function*(){return[...E(),...yield u.getCustomRpcs()].find((e=>e.uri===t||e.uri===t+"/"||e.uri+"/"===t))})),checkRpcStatus:t=>T(void 0,void 0,void 0,(function*(){i().interceptors.response.use((t=>t),(e=>{throw new Error("RPC NOK "+t+" "+e)}));try{const t=yield a.u.getData("condenser_api.get_config",[]);return!!(null==t?void 0:t.STEEM_ADDRESS_PREFIX)}catch(t){return _.A.error("error",t),!1}}))},O=u},68950:(t,e,n)=>{n.r(e),n.d(e,{useWorkingRPC:()=>_});var a=n(9201),o=n(21561),i=n(51616),r=n(73841),c=n(935),s=n(40416);const _=t=>{return e=void 0,n=void 0,T=function*(){const e=s.M.dispatch,n=yield c.A.getValueFromLocalStorage(r.Z.SWITCH_RPC_AUTO),_=t||s.M.getState().steem.activeRpc;for(const t of i.A.getFullList().filter((t=>t.uri!==(null==_?void 0:_.uri)&&!t.testnet)))if(yield i.A.checkRpcStatus(t.uri))return void(n?yield e((0,a.E)(t)):(e((0,o.l)(t)),e((0,o.Y)(!0))))},new((_=void 0)||(_=Promise))((function(t,a){function o(t){try{r(T.next(t))}catch(t){a(t)}}function i(t){try{r(T.throw(t))}catch(t){a(t)}}function r(e){var n;e.done?t(e.value):(n=e.value,n instanceof _?n:new _((function(t){t(n)}))).then(o,i)}r((T=T.apply(e,n||[])).next())}));var e,n,_,T}},70764:(t,e,n)=>{n.d(e,{A:()=>a});const a={mergeWithoutDuplicate:(t,e,n)=>{for(var a=[...t,...e],o=0;o<a.length;++o)for(var i=o+1;i<a.length;++i)n?a[o][n]===a[i][n]&&a.splice(i--,1):a[o]===a[i]&&a.splice(i--,1);return a},getMaxValue:(t,e)=>{let n=0;for(const a of t)(e&&a[e]>n||a>n)&&(n=e?a[e]:a);return n},getMinValue:(t,e)=>{let n=Number.MAX_SAFE_INTEGER;for(const a of t)(e&&a[e]<n||a<n)&&(n=e?a[e]:a);return n},findCommons:(t,e)=>{const n=[];for(const a of t)e.includes(a)&&n.push(a);return n}}}}]);
//# sourceMappingURL=950Bundle.js.map